<!DOCTYPE html>
<html>

<head>
  <script src="//api.salemove.com/salemove_integration.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-146480469-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-146480469-1');
  </script>
  <script>
    function recordGeoFromBrowser(engagement) {
      navigator.geolocation.getCurrentPosition(
        function success(position) {
          engagement.recordEvent({
            message: `Visitor location https://www.google.com/maps/place/${position.coords.latitude},${position.coords.longitude}`
          });
        },
        function error(error) {
          engagement.recordEvent({
            message: `Failed to get visitor geolocation ${error}`
          });
        });
    }
  </script>
  <title>Snowman</title>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <script>
    $(window).load(function() {
      if (window.ga && ga.create) {
        ga('create', 'UA-146480469-1', 'auto');
        console.info("ga tracker successfully created");
      }
    });
  </script>
  <script>
    sm.getApi({
      version: 'v1'
    }).then(function(glia) {
      function onEngagementStart(engagement) {
        console.log("Engagement started: " + engagement.engagementId);
        recordGeoFromBrowser(engagement);
      }

      function onQueueStateUpdate(queueState) {
        console.debug("Queue state updated: " + queueState);
        const element = document.querySelector('[data-sm-show-media-selection-on]');
        if (queueState.state !== queueState.QUEUE_STATES.CAN_QUEUE) {
          element.style.display = 'none';
        } else {
          element.style.display = 'block';
        }
      }
      glia.addEventListener(glia.EVENTS.ENGAGEMENT_START, onEngagementStart);
      glia.addEventListener(glia.EVENTS.QUEUE_STATE_UPDATE, onQueueStateUpdate);
    });
  </script>
  <script>
    function login() {
      console.log("Login");
      sm.getApi({
        version: 'v1'
      }).then(function(glia) {
        var params = {
          "authentication_provider_id": "289d329f-02d6-4d2e-8c42-d3c7d542a2c3",
          "webhooks": []
        };
        glia.createAuthenticationRequest(params);
      });
    }
  </script>
  <script>
    function setLocale() {
      var localeKey = document.getElementById("localesList").value;
      console.log("setLocale to " + localeKey);
      sm.getApi({
        version: 'v1'
      }).then(function(glia) {
        glia.setLocale(localeKey);
      });
    }
  </script>
  <script>
    //Place the following script in the footer
    sm.getApi({
      version: 'v1'
    }).then(
      function(salemoveApi) {
        salemoveApi.setupContactOperatorButton({
          withOperatorsHtml: `<img src="http://pngimg.com/uploads/buttons/buttons_PNG161.png"/>`,
          withoutOperatorsHtml: `<img src="http://pngimg.com/uploads/buttons/buttons_PNG154.png"/>`,
          withoutOperatorsCallback: function() {
            console.log("No ops.");
          }
        });
      },
      function(err) {}
    );
  </script>
</head>

<body>
  <div align="center" id="login">
    <button onclick="login()">Login</button>
  </div>
  <div align="center" id="click-to-call">
    <a data-sm-show-media-selection-on="click" href="javascript:void(0);">
      Click to engage!
    </a>
  </div>
  <div align="center" id="main">
    <a href="signup.html"><img src="https://www.pikpng.com/pngl/m/131-1314070_xmas-snowman-frozen-png-snowman-svg-free-clipart.png" alt="Let it snow"></a>
  </div>
  <div align="center" id="locale">
    <select id="localesList" onchange="setLocale()">
      <option value="de-DE">German</option>
      <option value="de-DE-AS">German Customized</option>
    </select>
  </div>
</body>

</html>
